{% extends 'main/main.html' %}
{% load my_filters %}


{% block main %}


<div class="container-fluid">
    <div class="row">
        <div class="col order-last order-sm-first calendar-header-title">
            <a type="button" style="text-decoration: none;" onclick="Admin1(this)">
                <h1 class="title-cal title-menu title-menu-success">Календарь</h1>
            </a>
        </div>

    </div>
</div>






<div class="sl-r"></div>
<main id="main-calendar" class="main">
    <div class="container-fluid">
        <div class="row">
            <div class="col d-flex justify-content-center" style="margin-top: 2rem;">
                {% comment %} <!-------------------MONTH-BUTTON-----------> {% endcomment %}
                <select name="month-swith" id="month-swith_id" style="margin-right: 1rem;"
                    onchange="MonthSwith(this.value)" class="form-select form-select-castom btn-primary"
                    aria-label="Default select example">
                    {% for month in months %}

                    {% if month.month_index == current_month %}
                    <option value="{{month.month_index}}" selected>
                        <p class="text-sections">{{month.month_name}}</p>
                    </option>
                    {% else %}
                    <option value="{{month.month_index}}">
                        <p class="text-sections">{{month.month_name}}</p>
                    </option>

                    {% endif %}
                    {% endfor %}


                </select>
                {% comment %} <!-------------------MONTH-BUTTON-----------> {% endcomment %}


                {% comment %} <!-------------------YEAR-BUTTON-----------> {% endcomment %}
                <select name="year-swith" id="year-swith_id" onchange="YearSwith(this.value)"
                    class="form-select form-select-castom form-select-castom-small btn-primary"
                    aria-label="Default select example">
                    {% for year in years %}

                    {% if year == current_year %}
                    <option value="{{ year }}" selected>
                        <p class="text-sections">{{ year }}</p>
                    </option>
                    {% else %}
                    <option value="{{year}}">
                        <p class="text-sections">{{year}}</p>
                    </option>

                    {% endif %}
                    {% endfor %}


                </select>
                {% comment %} <!-------------------YEAR-BUTTON-----------> {% endcomment %}
            </div>
        </div>
    </div>

    <a href="#" id="swithMonthLink" style="display: none;">sdvdsfgdsffg</a>
    <div class="container-fluid">
        <div class="row row-cols-1 row-cols-sm-3 row-cols-lg-6">
            {% for day in fill_cal %}
            <div class="col" id="day-{{day.date}}" style="margin-bottom: 2rem;">
                <div class="card" style="height: 20rem; margin-top: 2rem; min-width: 200px;">
                    {% if day.date == today.date %}
                    <div class="header card-headder headeer-calendar headeer-calendar-today" id="today">
                        <p class="text-sections text-sections-zapisi">{{day.date}}<br>{{day.date|weekday}}</p>
                    </div>
                    {% else %}
                    <div class="header card-headder headeer-calendar">
                        <p class="text-sections text-sections-zapisi">{{day.date}}<br>{{day.date|weekday}}</p>
                    </div>
                    {% endif %}
                    <div class="main card-body main-calendar">
                        <form class="w-100" action="" method="post" style="text-align: center;">
                            {% csrf_token %}
                            
                          


                                        <button id="addTren-{{day.date}}" name="addTren"
                                            value="{{day.date|date:'Y-m-d'}}" type="submit" class="btn btn-add"><i
                                                class="fa-sharp fa-solid fa-plus fa-2xl"></i></button><br>

                                        {% for tren in trenya %}
                                        {% if day.date == tren.date %}
                                        {% if tren.user == request.user %}
                                        <a
                                            href="{% url 'uprs' %}?addUpr={{day.date|date:'Y-m-d'}}&group={{tren.group}}&id={{tren.id}}"><button
                                                id="{{tren.group}}" name="addUpr" value="{{tren.date}}" type="button"
                                                class="btn btn-calendar">
                                                {{tren.group}}
                                            </button>
                                        </a>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <button class="btn btn-delete" type="button" id="delTren-{{day.date}}" value="delTrenOn-{{day.date}}"
                                            style="display: none;" onclick="DeleteVisible(this.value)"><i
                                                class="fa-solid fa-trash fa-2xl" style="color: #a73535;"></i></button>
                                        <button id="delTrenOn-{{day.date}}" name="delTren"
                                            value="{{day.date|date:'Y-m-d'}}" type="submit" class="btn btn-delete"
                                            style="display: none;">Удалить?</button><br>
                                            

                           
                        
                        <script>

                            document.getElementById('addTren-{{day.date}}').setAttribute('style', 'display: none');
                            document.getElementById('delTren-{{day.date}}').setAttribute('style', '');



                        </script>
                        <script>
                            function DeleteVisible(id) {
                                document.getElementById(id).setAttribute('style', 'background-color: red;');
                                setTimeout(() => {
                                    document.getElementById(id).setAttribute('style', 'display: none;');
                                }, 3000)
                            }
                        </script>
                        {% endif %}
                        {% endif %}
                        {% endfor %}
                    </form>

                    </div>

                </div>


            </div>
            {% endfor %}
        </div>
    </div>

</main>




<script>
    function MonthSwith(value) {
        var link = document.getElementById('swithMonthLink');
        var year = document.getElementById('year-swith_id').value
        link.setAttribute('href', `?monthSwitch=${value}&yearSwitch=${year}`);
        link.click();
    }
</script>
<script>
    function YearSwith(value) {
        var link = document.getElementById('swithMonthLink');
        var month = document.getElementById('month-swith_id').value
        link.setAttribute('href', `?monthSwitch=${month}&yearSwitch=${value}`);
        link.click();
    }
</script>
<script>
    function Today() {
        location = '/calendar'
    }
</script>

<script>
    window.addEventListener('load', () => {

        document.getElementById("today").scrollIntoView();


    });
</script>

<script>
    function Admin1(me) {
        me.setAttribute('onclick', 'Admin2(this)');
        setTimeout( ()=>{
            me.setAttribute('onclick', 'Admin1(this)');
        }, 1000 );
    }
</script>
<script>
    function Admin2(me) {
        me.setAttribute('onclick', 'Admin3(this)');
        setTimeout( ()=>{
            me.setAttribute('onclick', 'Admin2(this)');
        }, 1000 );
    }
</script>
<script>
    function Admin3(me) {
        me.setAttribute('onclick', 'Admin4(this)');
        setTimeout( ()=>{
            me.setAttribute('onclick', 'Admin3(this)');
        }, 1000 );
    }
</script>
<script>
    function Admin4(me) {
        me.setAttribute('onclick', 'Admin5(this)');
        me.setAttribute('href', 'admin');

        setTimeout( ()=>{
            me.setAttribute('onclick', 'Admin4(this)');
            me.removeAttribute('href');
        }, 1000 );
    }
</script>





{% comment %} <canvas id="lineChart"></canvas>

  <script>
    // Настройка данных для графика
    const ctx = document.getElementById('lineChart').getContext('2d');
    const lineChart = new Chart(ctx, {
      type: 'line',  // Тип графика (линейный)
      data: {
        labels: ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь'],  // Метки на оси X
        datasets: [{
          label: 'Продажи (в тыс. ед.)',
          data: [10, 20, 30, 40, 50, 60],  // Данные для графика
          borderColor: 'rgba(75, 192, 192, 1)',  // Цвет линии
          backgroundColor: 'rgba(75, 192, 192, 0.2)',  // Цвет фона линии (заливка под графиком)
          fill: true,  // Заполнение области под графиком
          tension: 0.1  // Степень сглаживания линии
        }]
      },
      options: {
        responsive: true,  // Адаптивность графика
        scales: {
          y: {
            beginAtZero: true  // Ось Y начинается с нуля
          }
        }
      }
    });
  </script> {% endcomment %}
{% endblock %}